<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.53" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://oorzc.cn/extension-authoring/example-word-count.html"><meta property="og:site_name" content="vscodeæ’ä»¶å¼€å‘æ–‡æ¡£"><meta property="og:title" content="ç¤ºä¾‹ Word Count"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/icons/apple-touch-icon.png" type="image/png" sizes="512x512"><link rel="icon" href="/icons/apple-touch-icon.png" type="image/png" sizes="192x192"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#fff"><link rel="apple-touch-icon" href="/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/icons/apple-touch-icon.png"><meta name="msapplication-TileColor" content="#ffffff"><title>ç¤ºä¾‹ Word Count | vscodeæ’ä»¶å¼€å‘æ–‡æ¡£</title><meta name="description" content="vscodeæ’ä»¶å¼€å‘æ–‡æ¡£">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style.28776aee.css" as="style" /><link rel="stylesheet" href="/assets/style.28776aee.css" />
    <link rel="modulepreload" href="/assets/app.ed9f300c.js"><link rel="modulepreload" href="/assets/example-word-count.html.5ea29213.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/example-word-count.html.6c28cceb.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.jpg" alt="vscodeæ’ä»¶å¼€å‘æ–‡æ¡£"><!----><span class="site-name hide-in-pad">vscodeæ’ä»¶å¼€å‘æ–‡æ¡£</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!----><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><!----><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><div id="docsearch-container"></div><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">é¢„å¤‡çŸ¥è¯†</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">api</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">ç¬¬ä¸€æ­¥</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">å¼€å‘æ’ä»¶</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">æ’ä»¶åŠŸèƒ½</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">æ’ä»¶æŒ‡å—</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">è¯­è¨€æ’ä»¶</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">è¿›é˜¶ä¸»é¢˜</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">ï¸ï¸å‚è€ƒ</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">å…¶ä»–1</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">å…¶ä»–2</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/extension-authoring/developing-extensions.html" class="nav-link sidebar-link sidebar-page" aria-label="å¼€å‘æ’ä»¶"><!---->å¼€å‘æ’ä»¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extension-authoring/example-debug-adapter.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¤ºä¾‹-è°ƒè¯•é€‚é…å™¨"><!---->ç¤ºä¾‹-è°ƒè¯•é€‚é…å™¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extension-authoring/example-hello-world.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¤ºä¾‹ï¼šHello World"><!---->ç¤ºä¾‹ï¼šHello World<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extension-authoring/example-language-server.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¤ºä¾‹ï¼šè¯­è¨€æœåŠ¡å™¨"><!---->ç¤ºä¾‹ï¼šè¯­è¨€æœåŠ¡å™¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extension-authoring/example-tasks.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¤ºä¾‹-ä»»åŠ¡"><!---->ç¤ºä¾‹-ä»»åŠ¡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/extension-authoring/example-word-count.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="ç¤ºä¾‹ Word Count"><!---->ç¤ºä¾‹ Word Count<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/extension-authoring/example-word-count.html#æœ¬èŠ‚è¦ç‚¹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æœ¬èŠ‚è¦ç‚¹"><!---->æœ¬èŠ‚è¦ç‚¹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extension-authoring/example-word-count.html#æ›´æ–°çŠ¶æ€æ " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ›´æ–°çŠ¶æ€æ "><!---->æ›´æ–°çŠ¶æ€æ <!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extension-authoring/example-word-count.html#è®¢é˜…äº‹ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è®¢é˜…äº‹ä»¶"><!---->è®¢é˜…äº‹ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extension-authoring/example-word-count.html#è‡ªå®šä¹‰çŠ¶æ€æ " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªå®šä¹‰çŠ¶æ€æ "><!---->è‡ªå®šä¹‰çŠ¶æ€æ <!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extension-authoring/example-word-count.html#é‡Šæ”¾æ’ä»¶èµ„æº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é‡Šæ”¾æ’ä»¶èµ„æº"><!---->é‡Šæ”¾æ’ä»¶èµ„æº<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extension-authoring/example-word-count.html#åœ¨æœ¬åœ°å®‰è£…ä½ çš„æ’ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åœ¨æœ¬åœ°å®‰è£…ä½ çš„æ’ä»¶"><!---->åœ¨æœ¬åœ°å®‰è£…ä½ çš„æ’ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extension-authoring/example-word-count.html#å‘å¸ƒæ’ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‘å¸ƒæ’ä»¶"><!---->å‘å¸ƒæ’ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extension-authoring/example-word-count.html#ä¸‹ä¸€æ­¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸‹ä¸€æ­¥"><!---->ä¸‹ä¸€æ­¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/extension-authoring/extension-generator.html" class="nav-link sidebar-link sidebar-page" aria-label="æ’ä»¶ç”Ÿæˆå™¨"><!---->æ’ä»¶ç”Ÿæˆå™¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extension-authoring/overview.html" class="nav-link sidebar-link sidebar-page" aria-label="æ‰©å±•Visual Studio Code"><!---->æ‰©å±•Visual Studio Code<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extension-authoring/publish-extension.html" class="nav-link sidebar-link sidebar-page" aria-label="å‘å¸ƒæ’ä»¶"><!---->å‘å¸ƒæ’ä»¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extension-authoring/samples.html" class="nav-link sidebar-link sidebar-page" aria-label="VS Code æ’ä»¶ç¤ºä¾‹"><!---->VS Code æ’ä»¶ç¤ºä¾‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extension-authoring/testing-extensions.html" class="nav-link sidebar-link sidebar-page" aria-label="æµ‹è¯•ä½ çš„æ’ä»¶"><!---->æµ‹è¯•ä½ çš„æ’ä»¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extension-authoring/themes-snippets-colorizers.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸»é¢˜ï¼Œä»£ç ç‰‡æ®µå’Œç€è‰²å™¨"><!---->ä¸»é¢˜ï¼Œä»£ç ç‰‡æ®µå’Œç€è‰²å™¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extension-authoring/webview-api.html" class="nav-link sidebar-link sidebar-page" aria-label="VS Code Webview API"><!---->VS Code Webview API<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->ç¤ºä¾‹ Word Count</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="author-item">oorzc</span></span><span property="author" content="oorzc"></span></span><!----><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 6 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT6M"></span><span class="words-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 1945 å­—</span><meta property="wordCount" content="1945"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/extension-authoring/example-word-count.html#æœ¬èŠ‚è¦ç‚¹" class="router-link-active router-link-exact-active toc-link level2">æœ¬èŠ‚è¦ç‚¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extension-authoring/example-word-count.html#æ›´æ–°çŠ¶æ€æ " class="router-link-active router-link-exact-active toc-link level2">æ›´æ–°çŠ¶æ€æ </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extension-authoring/example-word-count.html#è®¢é˜…äº‹ä»¶" class="router-link-active router-link-exact-active toc-link level2">è®¢é˜…äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extension-authoring/example-word-count.html#è‡ªå®šä¹‰çŠ¶æ€æ " class="router-link-active router-link-exact-active toc-link level2">è‡ªå®šä¹‰çŠ¶æ€æ </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extension-authoring/example-word-count.html#é‡Šæ”¾æ’ä»¶èµ„æº" class="router-link-active router-link-exact-active toc-link level2">é‡Šæ”¾æ’ä»¶èµ„æº</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extension-authoring/example-word-count.html#åœ¨æœ¬åœ°å®‰è£…ä½ çš„æ’ä»¶" class="router-link-active router-link-exact-active toc-link level2">åœ¨æœ¬åœ°å®‰è£…ä½ çš„æ’ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extension-authoring/example-word-count.html#å‘å¸ƒæ’ä»¶" class="router-link-active router-link-exact-active toc-link level2">å‘å¸ƒæ’ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extension-authoring/example-word-count.html#ä¸‹ä¸€æ­¥" class="router-link-active router-link-exact-active toc-link level2">ä¸‹ä¸€æ­¥</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="ç¤ºä¾‹-word-count" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-word-count" aria-hidden="true">#</a> ç¤ºä¾‹ Word Count</h1><p>å¦‚æœä½ è¿˜æ²¡æœ‰æ¥è§¦è¿‡<a href="/extension-authoring/example-hello-world.html" class="">ä½ çš„ç¬¬ä¸€ä¸ªæ’ä»¶</a>ç« èŠ‚ï¼Œæˆ‘ä»¬å»ºè®®ä½ å…ˆå»äº†è§£ä¸€ä¸‹ã€‚</p><p>æœ¬ç¯‡ç¤ºä¾‹å°†ä¼šå‘Šè¯‰ä½ ï¼Œå¦‚ä½•åˆ¶ä½œä¸€ä¸ªMarkdownè¾…åŠ©ç¼–è¾‘å·¥å…·ã€‚å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹æœ¬ç¯‡ä½ å°†æ¥è§¦åˆ°çš„æ’ä»¶åŠŸèƒ½ï¼šå½“ç¼–è¾‘Makrdownæ–‡ä»¶æ—¶çŠ¶æ€æ ä¼šæ˜¾ç¤ºç¼–è¾‘åŒºå­—æ•°ï¼Œå¦‚æœä½ ç¼–è¾‘æ–‡æ¡£æˆ–è€…æ‰“å¼€äº†å¦ä¸€ä¸ªmdæ–‡ä»¶å­—æ•°ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-word-count/wordcountevent2.gif" alt=""></p><p>?&gt; å°è´´å£«ï¼šå¦‚æœä½ ç¢°åˆ°äº†ä»€ä¹ˆé—®é¢˜ï¼Œå¯ä»¥åœ¨è¿™é‡Œ<a href="https://github.com/microsoft/vscode-wordcount" target="_blank" rel="noopener noreferrer">ä¸‹è½½å®Œæ•´çš„é¡¹ç›®<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>è¿›è¡Œè°ƒè¯•</p><h2 id="æœ¬èŠ‚è¦ç‚¹" tabindex="-1"><a class="header-anchor" href="#æœ¬èŠ‚è¦ç‚¹" aria-hidden="true">#</a> æœ¬èŠ‚è¦ç‚¹</h2><p>æœ¬ç« å°†é€šè¿‡ä¸‰ä¸ªéƒ¨åˆ†è®©ä½ äº†è§£vscodeæœ‰å…³çš„æ¦‚å¿µï¼š</p><ul><li><a href="#%E6%9B%B4%E6%96%B0%E7%8A%B6%E6%80%81%E6%A0%8F">æ›´æ–°çŠ¶æ€æ </a> - åœ¨<em>çŠ¶æ€æ </em>ä¸­æ˜¾ç¤ºè‡ªå®šä¹‰æ–‡æœ¬</li><li><a href="#%E8%AE%A2%E9%98%85%E4%BA%8B%E4%BB%B6">è®¢é˜…äº‹ä»¶</a> - é€šè¿‡ç¼–è¾‘å™¨äº‹ä»¶æ›´æ–°<em>çŠ¶æ€æ </em></li><li><a href="#%E9%87%8A%E6%94%BE%E6%8F%92%E4%BB%B6%E8%B5%84%E6%BA%90">é‡Šæ”¾æ’ä»¶èµ„æº</a> - æ¯”å¦‚ï¼šé‡Šæ”¾äº‹ä»¶è®¢é˜…å’ŒUIå›è°ƒå‡½æ•°</li></ul><p>å¦‚æœä½ è¿˜ä¸ç†Ÿæ‚‰ç”Ÿæˆæ’ä»¶çš„æ­¥éª¤ï¼Œè¯·å…ˆäº†è§£ä¹‹å‰çš„ç« èŠ‚ï¼š<a href="/extension-authoring/extension-generator?id=%E8%BF%90%E8%A1%8Cyo-code%F0%9F%98%8E">ç”Ÿæˆæ’ä»¶-è¿è¡ŒYo</a></p><p>å°±åƒä½ ä¹‹å‰åœ¨<a href="/extension-authoring/example-hello-world.html" class="">ç¤ºä¾‹ï¼šHello-world</a>ä¸­åšçš„ä¸€æ ·ï¼Œä½¿ç”¨<code>F5</code>æˆ–è€…<code>Cmd + R</code>è¿è¡Œè¯¥é¡¹ç›®ã€‚</p><h2 id="æ›´æ–°çŠ¶æ€æ " tabindex="-1"><a class="header-anchor" href="#æ›´æ–°çŠ¶æ€æ " aria-hidden="true">#</a> æ›´æ–°çŠ¶æ€æ </h2><hr><p>å°†ä¸‹åˆ—ä»£ç æ›´æ–°åˆ°<code>extension.ts</code>ä¸­ã€‚è¿™æ®µä»£ç å£°æ˜äº†ä¸€ä¸ª<code>WordCounter</code>ç±»ç”¨äºæ§åˆ¶æ–‡æœ¬è®¡æ•°å¹¶æ˜¾ç¤ºåˆ°çŠ¶æ€æ ä¸­ï¼Œæˆ‘ä»¬ä¾ç„¶ç”¨äº†&quot;Hello World&quot;è¿™ä¸ªå‘½ä»¤æ¥æ‰§è¡Œ<code>updateWordCount</code>ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// &#39;vscode&#39;æ¨¡å—åŒ…å«äº†VS Codeæ‰©å±•æ€§API</span>
<span class="token comment">// å¯¼å…¥ä½ è¦ç”¨åˆ°çš„æ‰©å±•ç±»</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
window<span class="token punctuation">,</span> 
commands<span class="token punctuation">,</span> 
Disposable<span class="token punctuation">,</span> 
ExtensionContext<span class="token punctuation">,</span> 
StatusBarAlignment<span class="token punctuation">,</span> 
StatusBarItem<span class="token punctuation">,</span> TextDocument
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vscode&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// å½“ä½ çš„æ’ä»¶æ¿€æ´»æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚&#39;activation&#39;æ˜¯package.jsonä¸­å®šä¹‰å¥½çš„activation events</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>context<span class="token operator">:</span> ExtensionContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// ç”¨consoleå¯¹è±¡è¾“å‡ºè¯Šæ–­å’Œé”™è¯¯ä¿¡æ¯(console.log / console.error).</span>
    <span class="token comment">// ä¸‹é¢è¿™è¡Œä»£ç ï¼Œåªä¼šåœ¨ä½ çš„æ’ä»¶æ¿€æ´»æ—¶æ‰§è¡Œä¸€æ¬¡</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Congratulations, your extension &quot;WordCount&quot; is now active!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ–°å»ºä¸€ä¸ªå­—æ•°è®¡æ•°å™¨</span>
    <span class="token keyword">let</span> wordCounter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WordCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> disposable <span class="token operator">=</span> commands<span class="token punctuation">.</span><span class="token function">registerCommand</span><span class="token punctuation">(</span><span class="token string">&#39;extension.sayHello&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        wordCounter<span class="token punctuation">.</span><span class="token function">updateWordCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æŠŠdisposablesæ·»åŠ åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œä»¥ä¾¿å…³é—­æ’ä»¶æ—¶é‡Šæ”¾èµ„æº</span>
    context<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>wordCounter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>disposable<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">WordCounter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> _statusBarItem<span class="token operator">:</span> StatusBarItem <span class="token operator">=</span>  window<span class="token punctuation">.</span><span class="token function">createStatusBarItem</span><span class="token punctuation">(</span>StatusBarAlignment<span class="token punctuation">.</span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">updateWordCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// è·å–å½“å‰ç¼–è¾‘å™¨</span>
        <span class="token keyword">let</span> editor <span class="token operator">=</span> window<span class="token punctuation">.</span>activeTextEditor<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>editor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_statusBarItem<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> doc <span class="token operator">=</span> editor<span class="token punctuation">.</span>document<span class="token punctuation">;</span>
        
        <span class="token comment">// åªå¯¹markdownæ–‡ä»¶ç”Ÿæ•ˆ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>languageId <span class="token operator">===</span> <span class="token string">&quot;markdown&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> wordCount <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getWordCount</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// æ›´æ–°çŠ¶æ€æ </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_statusBarItem<span class="token punctuation">.</span>text <span class="token operator">=</span> wordCount <span class="token operator">!==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>wordCount<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> Words</span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">&#39;1 Word&#39;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_statusBarItem<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_statusBarItem<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">_getWordCount</span><span class="token punctuation">(</span>doc<span class="token operator">:</span> TextDocument<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> docContent <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å»é™¤å¤šä½™ç©ºæ ¼</span>
        docContent <span class="token operator">=</span> docContent<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(&lt; ([^&gt;]+)&lt;)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\s+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        docContent <span class="token operator">=</span> docContent<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\s\s*</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\s\s*$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> wordCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>docContent <span class="token operator">!==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            wordCount <span class="token operator">=</span> docContent<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> wordCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_statusBarItem<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨è®©æˆ‘ä»¬è¯•è¯•æ›´æ–°æ’ä»¶å§ã€‚</p><p>åœ¨VS Codeä¸­ï¼ˆéå¼€å‘ä¸»æœºçª—å£ï¼‰æŒ‰ä¸‹<code>F5</code>æˆ–è€…ç›´æ¥æŒ‰é‡å¯æŒ‰é’®ã€‚å‡è®¾ä½ å·²ç»æ‰“å¼€äº†ä¸€ä¸ªmarkdownæ–‡ä»¶ï¼Œç„¶åå’ŒHello-Worldç¤ºä¾‹ä¸€æ ·ï¼Œæˆ‘ä»¬åœ¨<em>å‘½ä»¤é¢æ¿</em>ä¸­è¾“å…¥<code>Hello World</code>å¯åŠ¨æ’ä»¶ã€‚</p><p><img src="https://github.com/Microsoft/vscode-docs/raw/master/docs/extensions/images/example-word-count/wordcount2.png" alt=""></p><p>å¾ˆæ£’ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥åšæ›´coolçš„äº‹æƒ…â€”â€”å®æ—¶æ›´æ–°å­—æ•°ã€‚</p><h2 id="è®¢é˜…äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#è®¢é˜…äº‹ä»¶" aria-hidden="true">#</a> è®¢é˜…äº‹ä»¶</h2><hr><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹äº‹ä»¶ä¸­çš„ç±»æ–¹æ³•ï¼š</p><ul><li><code>onDidChangeTextEditorSelection</code> - é¼ æ ‡ä½ç½®å˜åŠ¨æ—¶è§¦å‘ã€‚</li><li><code>onDidChangeActiveTextEditor</code> - æ¿€æ´»ç¼–è¾‘å™¨ï¼ˆæ‰“å¼€çš„ç¼–è¾‘å™¨ï¼‰åˆ‡æ¢çš„æ—¶å€™è§¦å‘ã€‚</li></ul><p>ä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡ï¼Œæˆ‘ä»¬ç»™<code>extension.ts</code>æ·»åŠ ä¸€ä¸ªæ–°ç±»ï¼Œè®¢é˜…ä¸Šè¿°äº‹ä»¶ç„¶åè®©<code>WordCounter</code>æ›´æ–°å­—æ•°ã€‚</p><p>?&gt;åœ¨å®ç°æ—¶ï¼Œä½ éœ€è¦æ³¨æ„æˆ‘ä»¬æ˜¯å¦‚ä½•æŠŠ**æ¶ˆæ¯è®¢é˜…( subscription )<strong>è½¬æ¢ä¸º</strong>é‡Šæ”¾å™¨( Disposables )**æ¥ç®¡ç†çš„ï¼Œå®ƒå°†ç›‘å¬å¹¶é‡Šæ”¾è‡ªå·±ã€‚</p><p>æ ¹æ®ä¸‹åˆ—ä»£ç ï¼Œå°†<code>WordCounterController</code>ç±»æ·»åŠ åˆ°<code>extension.ts</code>æ–‡ä»¶åº•éƒ¨ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">WordCounterController</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> _wordCounter<span class="token operator">:</span> WordCounter<span class="token punctuation">;</span>
    <span class="token keyword">private</span> _disposable<span class="token operator">:</span> Disposable<span class="token punctuation">;</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span>wordCounter<span class="token operator">:</span> WordCounter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_wordCounter <span class="token operator">=</span> wordCounter<span class="token punctuation">;</span>

        <span class="token comment">// è®¢é˜… æ–‡æœ¬é€‰åŒºå˜æ›´ å’Œ ç¼–è¾‘å™¨æ¿€æ´»äº‹ä»¶</span>
        <span class="token keyword">let</span> subscriptions<span class="token operator">:</span> Disposable<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span><span class="token function">onDidChangeTextEditorSelection</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_onEvent<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> subscriptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span><span class="token function">onDidChangeActiveTextEditor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_onEvent<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> subscriptions<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ä¸ºå½“å‰æ–‡ä»¶æ›´æ–°è®¡æ•°å™¨</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_wordCounter<span class="token punctuation">.</span><span class="token function">updateWordCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æŠŠä¸¤ä¸ªäº‹ä»¶è®¢é˜…å™¨æ•´åˆæˆä¸€ä¸ªä¸´æ—¶å®¹å™¨</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_disposable <span class="token operator">=</span> Disposable<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token operator">...</span>subscriptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_disposable<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token function">_onEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_wordCounter<span class="token punctuation">.</span><span class="token function">updateWordCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬ä¸å¸Œæœ›é€šè¿‡æ‰§è¡Œå‘½ä»¤æ‰å¯åŠ¨è¯æ±‡è®¡æ•°æ’ä»¶ï¼Œè€Œæ˜¯markdownæ–‡ä»¶ä¸€æ‰“å¼€æ’ä»¶å°±åº”è¯¥å¯åŠ¨ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†<code>active</code>å‡½æ•°æ›¿æ¢æˆè¿™æ ·ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// è¾“å‡ºè¯Šæ–­ä¿¡æ¯</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Congratulations, your extension &quot;WordCount&quot; is now active!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ–°å»ºä¸€ä¸ªè¯æ±‡è®¡æ•°å™¨</span>
<span class="token keyword">let</span> wordCounter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WordCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> controller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WordCounterController</span><span class="token punctuation">(</span>wordCounter<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ’ä»¶å…³é—­æ—¶ï¼Œé‡Šæ”¾å™¨ä¼šè‡ªåŠ¨é‡Šæ”¾</span>
context<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>controller<span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>wordCounter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œæˆ‘ä»¬å¿…é¡»ä¿è¯<code>Markdown</code>æ–‡ä»¶æ‰“å¼€æ—¶æ‰æ¿€æ´»ã€‚åœ¨ä¹‹å‰çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡<code>extension.sayHello</code>å‘½ä»¤æ¿€æ´»æ’ä»¶ï¼Œè€Œæˆ‘ä»¬ç°åœ¨ç”¨ä¸åˆ°äº†ï¼Œåˆ é™¤<code>package.json</code>æ–‡ä»¶ä¸­åŸæ¥çš„<code>contributes</code>é”®ã€‚</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;commands&quot;</span><span class="token operator">:</span>
        <span class="token punctuation">[</span><span class="token punctuation">{</span>
            <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;extension.sayHello&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Hello World&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢æ‰ï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;activationEvents&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;onLanguage:markdown&quot;</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸º<a href="">onLanguage: ${language}</a>é…ç½®ä¸€ä¸ªè¯­è¨€ï¼Œåœ¨è¿™é‡Œæ˜¯&quot;markdown&quot; ã€‚è¿™æ ·ä¸€æ¥æ‰“å¼€è¿™ä¸€ç±»æ–‡ä»¶å°±ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶äº†ã€‚</p><p>é‡å¯æ’ä»¶(æŒ‰ä¸‹<code>Cmd + R</code>æˆ–è€…é‡å¯æŒ‰é’®)ï¼Œç„¶åæ–°å»ºä¸€ä¸ª<code>.md</code>æ–‡ä»¶ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°ä¸‹å›¾çš„æ•ˆæœã€‚</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-word-count/wordcountevent2.gif" alt=""></p><p>å¦‚æœä½ åœ¨<code>active</code>å‡½æ•°ä¸Šæ‰“äº†æ–­ç‚¹ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°markdownæ–‡ä»¶è¢«æ‰“å¼€æ—¶åªè§¦å‘äº†ä¸€æ¬¡ã€‚<code>WordCountController</code>æ„é€ å™¨è¿è¡Œä¹‹åï¼Œè®¢é˜…äº†ç¼–è¾‘å™¨äº‹ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬æ•´ä¸ªæ’ä»¶å°±æ­£å¸¸è¿è¡Œäº†ã€‚</p><h2 id="è‡ªå®šä¹‰çŠ¶æ€æ " tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰çŠ¶æ€æ " aria-hidden="true">#</a> è‡ªå®šä¹‰çŠ¶æ€æ </h2><hr><p>VS Codeå…è®¸ä½ å®šåˆ¶çŠ¶æ€æ çš„é¢œè‰²ã€å›¾æ ‡ã€æç¤ºæ–‡æœ¬ç­‰é¢å¤–æ ·å¼ã€‚å¦‚æœä½ ä¸æ¸…æ¥š<strong>çŠ¶æ€æ </strong>ç›¸å…³çš„APIï¼Œä½ å¯ä»¥æŸ¥çœ‹è¯¥ç±»å‹çš„ä»£ç æç¤ºï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡<code>vscode.d.ts</code>VS Codeæ‰©å±•æ€§APIæŸ¥çœ‹ï¼Œè¿™ä¸ªæ–‡ä»¶å°±åœ¨ä½ ç”Ÿæˆçš„é¡¹ç›®æ–‡ä»¶å¤¹é‡Œï¼Œåœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€<code>node_modules\vscode\vscode.d.ts</code>ï¼Œä½ èƒ½çœ‹åˆ°å®Œæ•´çš„æ‰©å±•æ€§ APIå’Œæ³¨é‡Šã€‚</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-word-count/vscode-d-ts.png" alt=""></p><p>æ›´æ–°StatusBarItemæ¥å£çš„ä»£ç </p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// æ›´æ–°çŠ¶æ€æ </span>
<span class="token keyword">this</span><span class="token punctuation">.</span>_statusBarItem<span class="token punctuation">.</span>text <span class="token operator">=</span> wordCount <span class="token operator">!==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">$(pencil) </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>wordCount<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> Words</span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">&#39;$(pencil) 1 Word&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>_statusBarItem<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·å°±åœ¨è®¡æ•°å·¦è¾¹æ˜¾ç¤ºäº†ä¸€ä¸ª<a href="https://octicons.github.com/" target="_blank" rel="noopener noreferrer">Github Oction<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>çš„<code>pencil</code>å›¾æ ‡</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-word-count/wordcount-pencil.png" alt=""></p><h2 id="é‡Šæ”¾æ’ä»¶èµ„æº" tabindex="-1"><a class="header-anchor" href="#é‡Šæ”¾æ’ä»¶èµ„æº" aria-hidden="true">#</a> é‡Šæ”¾æ’ä»¶èµ„æº</h2><hr><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥æ·±å…¥äº†è§£ä¸€ä¸‹VS Codeæ˜¯æ€ä¹ˆé€šè¿‡<a href="/extensibility-reference/principles-patterns?id=disposables%EF%BC%88%E9%87%8A%E6%94%BE%E5%99%A8%EF%BC%89">é‡Šæ”¾å™¨ï¼ˆDisposablesï¼‰</a>æ§åˆ¶èµ„æºçš„ã€‚</p><p>å½“ä¸€ä¸ªæ’ä»¶è¢«æ¿€æ´»ï¼Œå®ƒä¼šä¼ å…¥ä¸€ä¸ª<code>ExtensionContext</code>å¯¹è±¡ï¼Œ è¿™ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªç”¨äºè®¢é˜…é‡Šæ”¾å™¨ï¼ˆDisposableï¼‰çš„<code>subscriptions</code>æ–¹æ³•ã€‚æ’ä»¶å°†=é‡Šæ”¾å™¨æ·»åŠ åˆ°è¿™ä¸ªè®¢é˜…åˆ—è¡¨ä¸­ï¼ŒVS Codeåˆ™ä¼šåœ¨æ’ä»¶å…³é—­çš„æ—¶å€™é‡Šæ”¾è¿™äº›å¯¹è±¡ã€‚</p><p>å¾ˆå¤šèƒ½ç”Ÿæˆå·¥ä½œåŒºï¼ˆworkspaceï¼‰æˆ–è€…UIå¯¹è±¡çš„VS Code APIï¼ˆæ¯”å¦‚ï¼š<code>registerCommand</code>ï¼‰ä¼šè‡ªåŠ¨è¿”å›ä¸€ä¸ªé‡Šæ”¾å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨ä»–ä»¬çš„disposeæ–¹æ³•é‡Šæ”¾UIå…ƒç´ ã€‚</p><p>äº‹ä»¶åˆ™æœ‰æ‰€ä¸åŒï¼Œæ¯”å¦‚<code>onDid*</code>è¿™ç±»äº‹ä»¶è®¢é˜…å™¨ä¼šè¿”å›ä¸€ä¸ªé‡Šæ”¾å™¨ã€‚æ’ä»¶é€šè¿‡é‡Šæ”¾äº‹ä»¶çš„é‡Šæ”¾å™¨ï¼ˆDisposableï¼‰æ¥å–æ¶ˆå·²ç»è®¢é˜…çš„äº‹ä»¶ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­é‡Œï¼Œ<code>WordCountController</code>æŠŠäº‹ä»¶è®¢é˜…çš„é‡Šæ”¾å™¨ç›´æ¥ä¿å­˜åˆ°è‡ªå·±çš„é‡Šæ”¾å™¨åˆ—è¡¨ä¸­ï¼Œåœ¨æ’ä»¶å…³é—­æ—¶é‡Šæ”¾ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// è®¢é˜…é€‰åŒºå˜åŠ¨äº‹ä»¶å’Œç¼–è¾‘å™¨æ¿€æ´»äº‹ä»¶</span>
<span class="token keyword">let</span> subscriptions<span class="token operator">:</span> Disposable<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">onDidChangeTextEditorSelection</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_onEvent<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> subscriptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">onDidChangeActiveTextEditor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_onEvent<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> subscriptions<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æŠŠä¸¤ä¸ªäº‹ä»¶è®¢é˜…å™¨ç”Ÿæˆä¸€ä¸ªç»„åˆçš„ä¸´æ—¶å®¹å™¨</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>_disposable <span class="token operator">=</span> Disposable<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token operator">...</span>subscriptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åœ¨æœ¬åœ°å®‰è£…ä½ çš„æ’ä»¶" tabindex="-1"><a class="header-anchor" href="#åœ¨æœ¬åœ°å®‰è£…ä½ çš„æ’ä»¶" aria-hidden="true">#</a> åœ¨æœ¬åœ°å®‰è£…ä½ çš„æ’ä»¶</h2><hr><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ çš„æ’ä»¶éƒ½è¿˜è·‘åœ¨æ’ä»¶å¼€å‘æ¨¡å¼ä¸­ï¼Œè¦æƒ³è®©ä½ çš„æ’ä»¶åœ¨æ­£å¸¸çš„VS Codeä¸­è¿è¡Œèµ·æ¥å°†ä½ çš„æ’ä»¶å¤åˆ¶åˆ°<code>.vscode/extensions</code>ç›®å½•ä¸‹ã€‚</p><h2 id="å‘å¸ƒæ’ä»¶" tabindex="-1"><a class="header-anchor" href="#å‘å¸ƒæ’ä»¶" aria-hidden="true">#</a> å‘å¸ƒæ’ä»¶</h2><hr><p>å‚é˜…<a href="/extension-authoring/publish-extension.html" class="">åˆ†äº«æ’ä»¶</a></p><h2 id="ä¸‹ä¸€æ­¥" tabindex="-1"><a class="header-anchor" href="#ä¸‹ä¸€æ­¥" aria-hidden="true">#</a> ä¸‹ä¸€æ­¥</h2><p><a href="/extension-authoring/extension-generator.html" class="">æ’ä»¶ç”Ÿæˆå™¨</a> - å­¦ä¹ Yo Codeæ’ä»¶ç”Ÿæˆå™¨çš„æ›´å¤šé€‰é¡¹</p><p><a href="/extensibility-reference/overview.html" class="">Extenstion API</a> - æ’ä»¶APIæ¦‚è§ˆ</p><p><a href="/extension-authoring/publish-extension.html" class="">å‘å¸ƒæ’ä»¶</a> - å­¦ä¼šå¦‚ä½•åœ¨åº”ç”¨å¸‚åœºå‘å¸ƒä¸€ä¸ªå…¬å…±æ’ä»¶</p><p><a href="/extensibility-reference/vscode-api.html" class="">ç¼–è¾‘å™¨ API</a> - å­¦ä¹ æ›´å¤šæœ‰å…³æ–‡æ¡£, æ–‡æ¡£ç¼–è¾‘å™¨å’Œç¼–è¾‘çš„å†…å®¹</p><p><a href="/extension-authoring/samples.html" class="">æ›´å¤šæ’ä»¶ç¤ºä¾‹</a> - åœ¨æ’ä»¶ç¤ºä¾‹åˆ—è¡¨å­¦ä¹ å…¶ä»–ç”¨æ³•</p></div><!----><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><a href="/extension-authoring/example-tasks.html" class="nav-link prev" aria-label="ç¤ºä¾‹-ä»»åŠ¡"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->ç¤ºä¾‹-ä»»åŠ¡</div></a><a href="/extension-authoring/extension-generator.html" class="nav-link next" aria-label="æ’ä»¶ç”Ÿæˆå™¨"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">æ’ä»¶ç”Ÿæˆå™¨<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><a  href='http://beian.miit.gov.cn/' target='_blank'>æ¸ICPå¤‡17004152å·-4 | Copyright Â©  oorzc</a></div><!----></footer><!--]--></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app.ed9f300c.js" defer></script>
  </body>
</html>
