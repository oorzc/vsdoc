<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.53" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://oorzc.cn/extensibility-reference/language-extension-guidelines.html"><meta property="og:site_name" content="vscode插件开发文档"><meta property="og:title" content="语言插件指引"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/icons/apple-touch-icon.png" type="image/png" sizes="512x512"><link rel="icon" href="/icons/apple-touch-icon.png" type="image/png" sizes="192x192"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#fff"><link rel="apple-touch-icon" href="/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/icons/apple-touch-icon.png"><meta name="msapplication-TileColor" content="#ffffff"><title>语言插件指引 | vscode插件开发文档</title><meta name="description" content="vscode插件开发文档">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style.28776aee.css" as="style" /><link rel="stylesheet" href="/assets/style.28776aee.css" />
    <link rel="modulepreload" href="/assets/app.ed9f300c.js"><link rel="modulepreload" href="/assets/language-extension-guidelines.html.3c274305.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/language-extension-guidelines.html.69b53de0.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.jpg" alt="vscode插件开发文档"><!----><span class="site-name hide-in-pad">vscode插件开发文档</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!----><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><!----><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><div id="docsearch-container"></div><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">预备知识</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">api</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">第一步</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">开发插件</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">插件功能</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">插件指南</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">语言插件</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">进阶主题</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">️️参考</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">其他1</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/extensibility-reference/activation-events.html" class="nav-link sidebar-link sidebar-page" aria-label="激活事件 - package.json"><!---->激活事件 - package.json<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extensibility-reference/api-debugging.html" class="nav-link sidebar-link sidebar-page" aria-label="调试器API"><!---->调试器API<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extensibility-reference/api-markdown.html" class="nav-link sidebar-link sidebar-page" aria-label="Markdown插件"><!---->Markdown插件<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extensibility-reference/api-scm.html" class="nav-link sidebar-link sidebar-page" aria-label="VS Code中的源控制"><!---->VS Code中的源控制<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extensibility-reference/contribution-points.html" class="nav-link sidebar-link sidebar-page" aria-label="发布内容配置点"><!---->发布内容配置点<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extensibility-reference/document-selectors.html" class="nav-link sidebar-link sidebar-page" aria-label="文档选择器"><!---->文档选择器<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extensibility-reference/extension-manifest.html" class="nav-link sidebar-link sidebar-page" aria-label="插件清单文件——pacakge.json"><!---->插件清单文件——pacakge.json<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="语言插件指引"><!---->语言插件指引<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#基于配置的语言支持" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="基于配置的语言支持"><!---->基于配置的语言支持<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#语法高亮" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="语法高亮"><!---->语法高亮<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#源代码片段" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="源代码片段"><!---->源代码片段<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#智能括号匹配" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="智能括号匹配"><!---->智能括号匹配<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#编程语言支持" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="编程语言支持"><!---->编程语言支持<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示悬浮提示-hovers" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="显示悬浮提示（Hovers）"><!---->显示悬浮提示（Hovers）<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示代码补全提示" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="显示代码补全提示"><!---->显示代码补全提示<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#提供诊断信息" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="提供诊断信息"><!---->提供诊断信息<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#为函数和方法提供帮助信息" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="为函数和方法提供帮助信息"><!---->为函数和方法提供帮助信息<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示符号定义" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="显示符号定义"><!---->显示符号定义<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#查找符号的所有引用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="查找符号的所有引用"><!---->查找符号的所有引用<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#高亮文档中所有匹配的符号" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="高亮文档中所有匹配的符号"><!---->高亮文档中所有匹配的符号<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示文档中所有符号定义" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="显示文档中所有符号定义"><!---->显示文档中所有符号定义<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示文档中所有符号定义-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="显示文档中所有符号定义"><!---->显示文档中所有符号定义<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#修正错误和警告" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="修正错误和警告"><!---->修正错误和警告<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#codelens-——-为上下文提供源代码信息" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CodeLens —— 为上下文提供源代码信息"><!---->CodeLens —— 为上下文提供源代码信息<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#符号重命名" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="符号重命名"><!---->符号重命名<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#在编辑器中格式化源代码" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="在编辑器中格式化源代码"><!---->在编辑器中格式化源代码<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#对选中行进行格式化" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="对选中行进行格式化"><!---->对选中行进行格式化<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#对用户输入自动格式化" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="对用户输入自动格式化"><!---->对用户输入自动格式化<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示取色器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="显示取色器"><!---->显示取色器<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/extensibility-reference/overview.html" class="nav-link sidebar-link sidebar-page" aria-label="扩展性参考"><!---->扩展性参考<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extensibility-reference/principles-patterns.html" class="nav-link sidebar-link sidebar-page" aria-label="扩展性原则和模式"><!---->扩展性原则和模式<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extensibility-reference/vscode-api.html" class="nav-link sidebar-link sidebar-page" aria-label="/extensibility-reference/vscode-api.md"><!---->/extensibility-reference/vscode-api.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/extensibility-reference/vscode-api-commands.html" class="nav-link sidebar-link sidebar-page" aria-label="复杂命令"><!---->复杂命令<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">其他2</span><span class="arrow right"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->语言插件指引</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="author-item">oorzc</span></span><span property="author" content="oorzc"></span></span><!----><!----><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 15 分钟</span><meta property="timeRequired" content="PT15M"></span><span class="words-info" aria-label="字数🔠" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>约 4470 字</span><meta property="wordCount" content="4470"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#基于配置的语言支持" class="router-link-active router-link-exact-active toc-link level2">基于配置的语言支持</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#语法高亮" class="router-link-active router-link-exact-active toc-link level2">语法高亮</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#源代码片段" class="router-link-active router-link-exact-active toc-link level2">源代码片段</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#智能括号匹配" class="router-link-active router-link-exact-active toc-link level2">智能括号匹配</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#编程语言支持" class="router-link-active router-link-exact-active toc-link level2">编程语言支持</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示悬浮提示-hovers" class="router-link-active router-link-exact-active toc-link level2">显示悬浮提示（Hovers）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示代码补全提示" class="router-link-active router-link-exact-active toc-link level2">显示代码补全提示</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#提供诊断信息" class="router-link-active router-link-exact-active toc-link level2">提供诊断信息</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#为函数和方法提供帮助信息" class="router-link-active router-link-exact-active toc-link level2">为函数和方法提供帮助信息</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示符号定义" class="router-link-active router-link-exact-active toc-link level2">显示符号定义</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#查找符号的所有引用" class="router-link-active router-link-exact-active toc-link level2">查找符号的所有引用</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#高亮文档中所有匹配的符号" class="router-link-active router-link-exact-active toc-link level2">高亮文档中所有匹配的符号</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示文档中所有符号定义" class="router-link-active router-link-exact-active toc-link level2">显示文档中所有符号定义</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示文档中所有符号定义-1" class="router-link-active router-link-exact-active toc-link level2">显示文档中所有符号定义</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#修正错误和警告" class="router-link-active router-link-exact-active toc-link level2">修正错误和警告</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#codelens-——-为上下文提供源代码信息" class="router-link-active router-link-exact-active toc-link level2">CodeLens —— 为上下文提供源代码信息</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#符号重命名" class="router-link-active router-link-exact-active toc-link level2">符号重命名</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#在编辑器中格式化源代码" class="router-link-active router-link-exact-active toc-link level2">在编辑器中格式化源代码</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#对选中行进行格式化" class="router-link-active router-link-exact-active toc-link level2">对选中行进行格式化</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#对用户输入自动格式化" class="router-link-active router-link-exact-active toc-link level2">对用户输入自动格式化</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/extensibility-reference/language-extension-guidelines.html#显示取色器" class="router-link-active router-link-exact-active toc-link level2">显示取色器</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="语言插件指引" tabindex="-1"><a class="header-anchor" href="#语言插件指引" aria-hidden="true">#</a> 语言插件指引</h1><p>当你听到VS Code支持了一门语言，你一般能想到语法高亮、代码补全，或者还有调试支持。能想到这么多很好，但是语言插件还可以承担更多的任务。</p><p>通过适当地配置文件，语言插件可以语法高亮、代码片段和智能括号匹配，更多高级特性则可以通过VS Code的<a href="/extensibility-reference/vscode-api.html" class="">扩展性API</a>或者<a href="/extension-authoring/example-language-server.html" class="">语言服务器</a>来实现。</p><p>语言服务器是一个使用<a href="https://microsoft.github.io/language-server-protocol" target="_blank" rel="noopener noreferrer">language server protocol<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>通信的独立服务器。你能在适当的任务中使用适当的语言实现一个服务器，例如：你想支持一个非常棒的Python库，那你可能会想要用Python来实现你的语言服务器。如果你想要用Javascript或者Typescript实现语言服务器，那么直接用VS Code顶层的<a href="https://github.com/Microsoft/vscode-languageserver-node" target="_blank" rel="noopener noreferrer">npm modules<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>构建即可。</p><p>在实现语言支持时，你也可以自由选择你想要实现的language server protocol，在protocol的<code>initialize</code>方法中声明语言服务器的功能。</p><p>不过语言服务器架构并不是提供语言特性的唯一途径，你也可以在插件的主要代码中直接实现功能。在本章指引中，我们不仅展示了基于<strong>Language Server Protocol</strong>的实现（要求使用events和configuration），也展示了通过注册 <em>语言功能提供器(language feature provider)</em> <strong>直接实现</strong> 实现语言特性（如：<code>registerHoverProvider</code>）</p><p>为了让你更方便地决定哪些特性应该先实现，哪些应该是之后用来改进代码的，我们按language server protocol的类名和方法的出现顺序一一展示在下面。每个指引下面都包含了<strong>基础</strong>支持和<strong>进阶</strong>实现。</p><h2 id="基于配置的语言支持" tabindex="-1"><a class="header-anchor" href="#基于配置的语言支持" aria-hidden="true">#</a> 基于<strong>配置</strong>的语言支持</h2><hr><p><a href="#%E8%AF%AD%E6%B3%95%E9%AB%98%E4%BA%AE">语法高亮</a>，<a href="#%E6%BA%90%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5">代码片段</a>和<a href="#%E6%99%BA%E8%83%BD%E6%8B%AC%E5%8F%B7%E5%8C%B9%E9%85%8D">智能括号匹配</a>可以通过声明配置而不需要任何插件代码直接实现。</p><h4 id="语言标识符" tabindex="-1"><a class="header-anchor" href="#语言标识符" aria-hidden="true">#</a> 语言标识符</h4><p>VS Code 通过语言标识符映射不同的语言配置和对应的语言实现。语言标识符是<em>小写字符串</em>表示的编程语言或文件类型。例如，Javascript的语言ID是<code>javascript</code>，而Markdown文件则是<code>markdown</code>。已经支持的语言标识符可以在<a href="https://code.visualstudio.com/docs/languages/identifiers" target="_blank" rel="noopener noreferrer">这里<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>找到。</p><h2 id="语法高亮" tabindex="-1"><a class="header-anchor" href="#语法高亮" aria-hidden="true">#</a> 语法高亮</h2><hr><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/syntax-highlighting.png" alt=""></p><p>想要支持语法高亮，插件需要在<code>package.json</code>中注册一个TextMate语法<code>.tmLanguage</code>。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;languages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;markdown&quot;</span><span class="token punctuation">,</span>
            ...
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;grammars&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;markdown&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;scopeName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text.html.markdown&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./syntaxes/markdown.tmLanguage.json&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> ...
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>VS Code支持两种格式的语法文件——Plist（<code>.tmLanguage</code>）和JSON（<code>.tmLanguage.json</code>）。Plist文件因为过于混乱，通常我们会从其他语言编译而来，如：YAML。如果你需要创建一种全新的语法，我们更推荐使用JSON语法。</p><blockquote><p><strong>基础</strong></p></blockquote><blockquote><p>为一种简单的语法提供字符串、注释、关键字高亮</p></blockquote><blockquote><p><strong>进阶</strong></p></blockquote><blockquote><p>为语法提供术语、表达式解析，然后支持变量和函数引用等等的色彩支持。</p></blockquote><h2 id="源代码片段" tabindex="-1"><a class="header-anchor" href="#源代码片段" aria-hidden="true">#</a> 源代码片段</h2><hr><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/snippets.gif" alt="snippets"></p><p>有了代码片段之后，你可以用占位符的形式提供源代码片段模板。在插件的<code>package.json</code>中注册一个包含代码片段的文件。在<a href="https://code.visualstudio.com/docs/editor/userdefinedsnippets#_creating-your-own-snippets" target="_blank" rel="noopener noreferrer">创建你自己的代码片段<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>章节中学习更多VS Code代码片段协议。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;snippets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;javascript&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./snippets/javascript.json&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> ...
    <span class="token punctuation">]</span><span class="token punctuation">,</span> ...
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p></blockquote><blockquote><p>在这个例子中用占位符提供<code>markdown</code>代码片段：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;Insert ordered list&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token property">&quot;prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ordered list&quot;</span><span class="token punctuation">,</span>
   <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token string">&quot;1. ${first}&quot;</span><span class="token punctuation">,</span>
       <span class="token string">&quot;2. ${second}&quot;</span><span class="token punctuation">,</span>
       <span class="token string">&quot;3. ${third}&quot;</span><span class="token punctuation">,</span>
       <span class="token string">&quot;$0&quot;</span>
   <span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Insert ordered list&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><blockquote><p><strong>进阶</strong></p></blockquote><blockquote><p>用显式的tab符阻止引导用户，然后用嵌套的占位符快速开发：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;key: \&quot;value\&quot; (Hash Pair)&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;key&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token string">&quot;${1:key}: ${2:\&quot;${3:value}\&quot;}&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h2 id="智能括号匹配" tabindex="-1"><a class="header-anchor" href="#智能括号匹配" aria-hidden="true">#</a> 智能括号匹配</h2><hr><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/smart-editing.gif" alt="smart-editing"></p><p>在插件的<code>package.json</code>中进行配置</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;languages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;typescript&quot;</span><span class="token punctuation">,</span>
            ...
            <span class="token property">&quot;configuration&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./language-configuration.json&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> ...
    <span class="token punctuation">]</span>
    ...
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p></blockquote><blockquote><p>无</p></blockquote><blockquote><p><strong>进阶</strong></p></blockquote><blockquote><p>下面是一个Typescript示例：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;comments&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token property">&quot;lineComment&quot;</span><span class="token operator">:</span> <span class="token string">&quot;//&quot;</span><span class="token punctuation">,</span>
       <span class="token property">&quot;blockComment&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;/*&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*/&quot;</span> <span class="token punctuation">]</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token property">&quot;brackets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">[</span><span class="token string">&quot;{&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">&quot;[&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">&quot;(&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&gt;&quot;</span><span class="token punctuation">]</span>
   <span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token property">&quot;autoClosingPairs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">{</span> <span class="token property">&quot;open&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;close&quot;</span><span class="token operator">:</span> <span class="token string">&quot;}&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span> <span class="token property">&quot;open&quot;</span><span class="token operator">:</span> <span class="token string">&quot;[&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;close&quot;</span><span class="token operator">:</span> <span class="token string">&quot;]&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span> <span class="token property">&quot;open&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;close&quot;</span><span class="token operator">:</span> <span class="token string">&quot;)&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span> <span class="token property">&quot;open&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&#39;&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;close&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&#39;&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;notIn&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;comment&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span> <span class="token property">&quot;open&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\&quot;&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;close&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\&quot;&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;notIn&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;string&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span> <span class="token property">&quot;open&quot;</span><span class="token operator">:</span> <span class="token string">&quot;`&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;close&quot;</span><span class="token operator">:</span> <span class="token string">&quot;`&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;notIn&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;comment&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span> <span class="token property">&quot;open&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/**&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;close&quot;</span><span class="token operator">:</span> <span class="token string">&quot; */&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;notIn&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;string&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
   <span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token property">&quot;surroundingPairs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">[</span><span class="token string">&quot;{&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">&quot;[&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">&quot;(&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&gt;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">&quot;&#39;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">&quot;\&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\&quot;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">&quot;`&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;`&quot;</span><span class="token punctuation">]</span>
   <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h2 id="编程语言支持" tabindex="-1"><a class="header-anchor" href="#编程语言支持" aria-hidden="true">#</a> 编程语言支持</h2><hr><p>除上面介绍的语言特性外，剩下的特性需要写一些插件代码去处理VS Code的请求。你可以通过<a href="https://microsoft.github.io/language-server-protocol" target="_blank" rel="noopener noreferrer">language server protocol<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>将插件实现为独立的服务器，或者直接在插件的<code>active</code>方法内注册一个<em>供应器（provider）</em>。这两种方法在接下的篇章里面会分别以<strong>通过语言服务器实现</strong>和<strong>直接实现</strong>展示。</p><p>language server protocol方式遵循在<code>initialize</code>请求中确定服务器的能力，然后基于用户行为处理特定的请求。</p><p>直接实现方式则要求插件激活时注册好<em>特性供应器（feature provider）</em>，常常以<code>DocumentSelector</code>的出现作为供应器的标识。</p><p>在下面的例子里，是一个Go语言文件的供应器：</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token constant">GO_MODE</span><span class="token operator">:</span> vscode<span class="token punctuation">.</span>DocumentFilter <span class="token operator">=</span> <span class="token punctuation">{</span> language<span class="token operator">:</span> <span class="token string">&#39;go&#39;</span><span class="token punctuation">,</span> scheme<span class="token operator">:</span> <span class="token string">&#39;file&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="显示悬浮提示-hovers" tabindex="-1"><a class="header-anchor" href="#显示悬浮提示-hovers" aria-hidden="true">#</a> 显示悬浮提示（Hovers）</h2><hr><p><em>悬浮提示</em>提供了鼠标悬停处关于 符号/对象 的相关信息，显示的内容通常是符号的类型和描述。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/hovers.gif" alt="hovers"></p><h4 id="通过语言服务器实现" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>在<code>initialize</code>响应方法中，你的语言服务器首先要声明能够提供<em>悬浮提示</em></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;hoverProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>另外，你的语言服务器需要响应<code>textDocument/hover</code>请求。</p><h4 id="直接实现" tabindex="-1"><a class="header-anchor" href="#直接实现" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoHoverProvider</span> <span class="token keyword">implements</span> <span class="token class-name">HoverProvider</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideHover</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> TextDocument<span class="token punctuation">,</span> position<span class="token operator">:</span> Position<span class="token punctuation">,</span> token<span class="token operator">:</span> CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>Hover<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerHoverProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoHoverProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p></blockquote><blockquote><p>显示一些类型信息，也可以显示文档。</p></blockquote><blockquote><p><strong>进阶</strong></p></blockquote><blockquote><p>按照你的主题对匹配的<em>method</em>进行着色</p></blockquote><h2 id="显示代码补全提示" tabindex="-1"><a class="header-anchor" href="#显示代码补全提示" aria-hidden="true">#</a> 显示代码补全提示</h2><hr><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/code-completion.gif" alt=""></p><p>代码补全提供了上下文感知，并为用户提供提示：</p><h4 id="通过语言服务器实现-1" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-1" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>在<code>initialize</code>响应方法中，你的语言服务器首先要声明能够提供<em>代码补全</em>，在<code>completionItem\resolve</code>方法中对计算出得补全项添加其他信息。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;completionProvider&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;resolveProvider&quot;</span><span class="token operator">:</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;triggerCharacters&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> &#39;.&#39; <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-1" tabindex="-1"><a class="header-anchor" href="#直接实现-1" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoCompletionItemProvider</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>CompletionItemProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideCompletionItems</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">,</span> position<span class="token operator">:</span> vscode<span class="token punctuation">.</span>Position<span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>CompletionItem<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">getDisposable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerCompletionItemProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoCompletionItemProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;.&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>不需要你提供解析函数</p></blockquote><blockquote><p><strong>进阶</strong></p><p>为用户选择的代码补全项提供解析函数和其他信息，信息就显示在选中项的旁边。</p></blockquote><h2 id="提供诊断信息" tabindex="-1"><a class="header-anchor" href="#提供诊断信息" aria-hidden="true">#</a> 提供诊断信息</h2><hr><p>诊断信息是一种提示代码错误的常见方式。</p><h4 id="通过语言服务器实现-2" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-2" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>你的语言服务器将<code>textDocument/publishDiagnostics</code>信息发送给语言客户端。这个信息由一系列包含诊断项和源URI的数组组成。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/diagnostics.gif" alt="diagnostics"></p><p>**注意：**客户端不会主动向服务器要诊断信息，而是服务器将诊断信息推送给客户端。</p><h4 id="直接实现-2" tabindex="-1"><a class="header-anchor" href="#直接实现-2" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">let</span> diagnosticCollection<span class="token operator">:</span> vscode<span class="token punctuation">.</span>DiagnosticCollection<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">getDisposable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  diagnosticCollection <span class="token operator">=</span> vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">createDiagnosticCollection</span><span class="token punctuation">(</span><span class="token string">&#39;go&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>diagnosticCollection<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> uri <span class="token operator">=</span> document<span class="token punctuation">.</span>uri<span class="token punctuation">;</span>
  <span class="token function">check</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span>fsPath<span class="token punctuation">,</span> goConfig<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>errors <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    diagnosticCollection<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> diagnosticMap<span class="token operator">:</span> Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> vscode<span class="token punctuation">.</span>Diagnostic<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    errors<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> canonicalFile <span class="token operator">=</span> vscode<span class="token punctuation">.</span>Uri<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>file<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> range <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>line<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>startColumn<span class="token punctuation">,</span> error<span class="token punctuation">.</span>line<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>endColumn<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> diagnostics <span class="token operator">=</span> diagnosticMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>canonicalFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>diagnostics<span class="token punctuation">)</span> <span class="token punctuation">{</span> diagnostics <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      diagnostics<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span><span class="token function">Diagnostic</span><span class="token punctuation">(</span>range<span class="token punctuation">,</span> error<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> error<span class="token punctuation">.</span>severity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      diagnosticMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>canonicalFile<span class="token punctuation">,</span> diagnostics<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    diagnosticMap<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>diags<span class="token punctuation">,</span> file<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      diagnosticCollection<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>vscode<span class="token punctuation">.</span>Uri<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">,</span> diags<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>为打开的编辑器提供诊断报告。较差的实现，每次保存时至少报告一次。更好的做法是，基于未保存的内容自动提供诊断。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>不仅仅为打开的编辑器报告诊断信息，而是为项目文件夹的所有资源提供诊断，不论这些资源是不是在编辑器中打开。</p></blockquote><h2 id="为函数和方法提供帮助信息" tabindex="-1"><a class="header-anchor" href="#为函数和方法提供帮助信息" aria-hidden="true">#</a> 为函数和方法提供帮助信息</h2><hr><p>当用户输入函数或者方法时，显示将要调用的函数/方法的相关信息。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/signature-help.gif" alt="signature-help"></p><h4 id="通过语言服务器实现-3" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-3" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>首先响应<code>initialize</code>方法，声明提供<em>特征值</em>支持，然后还要响应<code>textDocument/signatureHelp</code>请求</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;signatureHelpProvider&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;triggerCharacters&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> &#39;(&#39; <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-3" tabindex="-1"><a class="header-anchor" href="#直接实现-3" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoSignatureHelpProvider</span> <span class="token keyword">implements</span> <span class="token class-name">SignatureHelpProvider</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideSignatureHelp</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> TextDocument<span class="token punctuation">,</span> position<span class="token operator">:</span> Position<span class="token punctuation">,</span> token<span class="token operator">:</span> CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        <span class="token builtin">Promise</span><span class="token operator">&lt;</span>SignatureHelp<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerSignatureHelpProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoSignatureHelpProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;(&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;,&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>确保signature help函数中包含了函数或方法的文档说明。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>无</p></blockquote><h2 id="显示符号定义" tabindex="-1"><a class="header-anchor" href="#显示符号定义" aria-hidden="true">#</a> 显示符号定义</h2><hr><p>允许用户查看变量、函数、方法的定义。 <img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/goto-definition.gif" alt="goto-definition"></p><h4 id="通过语言服务器实现-4" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-4" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供转跳到定义位置的特性。当然你的语言服务器还需要响应<code>textDocument/definition</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;definitionProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-4" tabindex="-1"><a class="header-anchor" href="#直接实现-4" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoDefinitionProvider</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>DefinitionProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideDefinition</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">,</span> position<span class="token operator">:</span> vscode<span class="token punctuation">.</span>Position<span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>Location<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerDefinitionProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoDefinitionProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>如果符号的含义模棱两可，你把多个定义都显示出来。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>无</p></blockquote><h2 id="查找符号的所有引用" tabindex="-1"><a class="header-anchor" href="#查找符号的所有引用" aria-hidden="true">#</a> 查找符号的所有引用</h2><p>允许用户查看某个变量/函数/方法/符号的所有源代码的位置。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/find-references.gif" alt="find-references"></p><h4 id="通过语言服务器实现-5" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-5" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>定位符号引用</em>的特性。当然你的语言服务器还需要响应<code>textDocument/references</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;definitionProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-5" tabindex="-1"><a class="header-anchor" href="#直接实现-5" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoReferenceProvider</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>ReferenceProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideReferences</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">,</span> position<span class="token operator">:</span> vscode<span class="token punctuation">.</span>Position<span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span> includeDeclaration<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>Location<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerReferenceProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoReferenceProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>返回所有引用的位置（资源的URI和范围）。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>无</p></blockquote><h2 id="高亮文档中所有匹配的符号" tabindex="-1"><a class="header-anchor" href="#高亮文档中所有匹配的符号" aria-hidden="true">#</a> 高亮文档中所有匹配的符号</h2><p>允许用户查看打开的编辑器中所有匹配的符号。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/document-highlights.gif" alt=""></p><h4 id="通过语言服务器实现-6" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-6" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>文档符号定位</em>的特性。当然你的语言服务器还需要响应<code>textDocument/documentHighlight</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;documentHighlightProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-6" tabindex="-1"><a class="header-anchor" href="#直接实现-6" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoDocumentHighlightProvider</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>DocumentHighlightProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideDocumentHighlights</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">,</span> position<span class="token operator">:</span> vscode<span class="token punctuation">.</span>Position<span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        vscode<span class="token punctuation">.</span>DocumentHighlight<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>DocumentHighlight<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerDocumentHighlightProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoDocumentHighlightProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>你需要返回文档中找到的所有引用。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>无</p></blockquote><h2 id="显示文档中所有符号定义" tabindex="-1"><a class="header-anchor" href="#显示文档中所有符号定义" aria-hidden="true">#</a> 显示文档中所有符号定义</h2><hr><p>允许用户快速跳转到编辑器中的任何符号定义。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/document-symbols.gif" alt="document-symbols"></p><h4 id="通过语言服务器实现-7" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-7" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>文档符号定位</em>的特性。当然你的语言服务器还需要响应<code>textDocument/documentSymbol</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;documentSymbolProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-7" tabindex="-1"><a class="header-anchor" href="#直接实现-7" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoDocumentSymbolProvider</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>DocumentSymbolProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideDocumentSymbols</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>SymbolInformation<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerDocumentSymbolProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoDocumentSymbolProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>返回文档中的所有符号。定义的符号类型诸如：变量、函数、类、方法等。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>无</p></blockquote><h2 id="显示文档中所有符号定义-1" tabindex="-1"><a class="header-anchor" href="#显示文档中所有符号定义-1" aria-hidden="true">#</a> 显示文档中所有符号定义</h2><hr><p>允许用户快速跳转到打开的文件夹（工作区）中的任何符号定义。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/workspace-symbols.gif" alt="workspace-symbols"></p><h4 id="通过语言服务器实现-8" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-8" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>全局符号定位</em>的特性。当然你的语言服务器还需要响应<code>workspace/symbol</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;workspaceSymbolProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-8" tabindex="-1"><a class="header-anchor" href="#直接实现-8" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoWorkspaceSymbolProvider</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>WorkspaceSymbolProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideWorkspaceSymbols</span><span class="token punctuation">(</span>
        query<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>SymbolInformation<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerWorkspaceSymbolProvider</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">GoWorkspaceSymbolProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>返回打开文件中的所有符号。定义的符号类型诸如：变量、函数、类、方法等。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>无</p></blockquote><h2 id="修正错误和警告" tabindex="-1"><a class="header-anchor" href="#修正错误和警告" aria-hidden="true">#</a> 修正错误和警告</h2><hr><p>允许用户对错误或者警告进行更正。如果有可用的操作，就会有个灯泡💡出现在错误/警告旁边。当用户点击灯泡的时候，会出现可用的<em>代码操作</em>。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/quick-fixes.gif" alt="quick-fixes"></p><h4 id="通过语言服务器实现-9" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-9" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>代码操作</em>的特性。当然你的语言服务器还需要响应<code>textDocument/codeAction</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;codeActionProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-9" tabindex="-1"><a class="header-anchor" href="#直接实现-9" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoCodeActionProvider</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>CodeActionProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideCodeActions</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">,</span> range<span class="token operator">:</span> vscode<span class="token punctuation">.</span>Range<span class="token punctuation">,</span>
        context<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CodeActionContext<span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>Command<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerCodeActionsProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoCodeActionProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>为更正错误/警告提供<em>代码操作</em>。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>提供重构级别的源代码修改，如<strong>提取方法</strong></p></blockquote><h2 id="codelens-——-为上下文提供源代码信息" tabindex="-1"><a class="header-anchor" href="#codelens-——-为上下文提供源代码信息" aria-hidden="true">#</a> CodeLens —— 为上下文提供源代码信息</h2><hr><p>在横屏弹出框中为用户提供可操作的、上下文级别的源代码。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/code-lens.gif" alt="code-lens"></p><h4 id="通过语言服务器实现-10" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-10" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>CodeLens</em>的特性，将<code>textDocument/codeAction</code>绑定到<em>CodeLens</em>命令上。当然你的语言服务器还需要响应<code>textDocument/codeLens</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;codeLensProvider&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;resolveProvider&quot;</span><span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-10" tabindex="-1"><a class="header-anchor" href="#直接实现-10" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoRCodeLensProvider</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>CodeLensProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideCodeLenses</span><span class="token punctuation">(</span>document<span class="token operator">:</span> TextDocument<span class="token punctuation">,</span> token<span class="token operator">:</span> CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        CodeLens<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> Thenable<span class="token operator">&lt;</span>CodeLens<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> resolveCodeLens<span class="token operator">?</span><span class="token punctuation">(</span>codeLens<span class="token operator">:</span> CodeLens<span class="token punctuation">,</span> token<span class="token operator">:</span> CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
         CodeLens <span class="token operator">|</span> Thenable<span class="token operator">&lt;</span>CodeLens<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerCodeLensProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoCodeLensProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>定义当前文档可用的CodeLens结果</p></blockquote><blockquote><p><strong>进阶</strong></p><p>将CodeLens结果绑定到<code>codeLens/resolve</code>上</p></blockquote><h2 id="符号重命名" tabindex="-1"><a class="header-anchor" href="#符号重命名" aria-hidden="true">#</a> 符号重命名</h2><hr><p>运行用户重命名符号，更新所有引用的符号。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/rename.gif" alt="rename"></p><h4 id="通过语言服务器实现-11" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-11" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>重命名</em>特性。当然你的语言服务器还需要响应<code>textDocument/rename</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;renameProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-11" tabindex="-1"><a class="header-anchor" href="#直接实现-11" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoRenameProvider</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>RenameProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideRenameEdits</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">,</span> position<span class="token operator">:</span> vscode<span class="token punctuation">.</span>Position<span class="token punctuation">,</span>
        newName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>WorkspaceEdit<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerRenameProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoRenameProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>不提供重命名支持。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>返回工作区所有需要执行更改的编辑区，例如：跨文件查找引用了相关符号的编辑区。</p></blockquote><h2 id="在编辑器中格式化源代码" tabindex="-1"><a class="header-anchor" href="#在编辑器中格式化源代码" aria-hidden="true">#</a> 在编辑器中格式化源代码</h2><hr><p>为用户提供整个文档的格式化特性。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/format-document.gif" alt="format-document"></p><h4 id="通过语言服务器实现-12" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-12" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>格式化</em>特性。当然你的语言服务器还需要响应<code>textDocument/formatting</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;documentFormattingProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-12" tabindex="-1"><a class="header-anchor" href="#直接实现-12" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoDocumentFormatter</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>DocumentFormattingEditProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>TextEdit<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerDocumentFormattingEditProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoDocumentFormatter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>不提供格式化支持。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>不管多小的文本区域都不要放过，尽可能地对文档进行格式化，这对诊断信息提示至关重要，不然可能导致代码错误位置不正确或者丢失报错标记。</p></blockquote><h2 id="对选中行进行格式化" tabindex="-1"><a class="header-anchor" href="#对选中行进行格式化" aria-hidden="true">#</a> 对选中行进行格式化</h2><hr><p>为用户提供选中片段的格式化特性。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/format-document-range.gif" alt="format-document-range"></p><h4 id="通过语言服务器实现-13" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-13" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>选中片段格式化</em>特性。当然你的语言服务器还需要响应<code>textDocument/rangeFormatting</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;documentRangeFormattingProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-13" tabindex="-1"><a class="header-anchor" href="#直接实现-13" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoDocumentRangeFormatter</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>DocumentRangeFormattingEditProvider<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideDocumentRangeFormattingEdits</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">,</span> range<span class="token operator">:</span> vscode<span class="token punctuation">.</span>Range<span class="token punctuation">,</span>
        options<span class="token operator">:</span> vscode<span class="token punctuation">.</span>FormattingOptions<span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>TextEdit<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerDocumentRangeFormattingEditProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoDocumentRangeFormatter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>不提供格式化支持。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>不管多小的文本区域都不要放过，尽可能地对文档进行格式化，这对诊断信息提示至关重要，不然可能导致代码错误位置不正确或者丢失报错标记。</p></blockquote><h2 id="对用户输入自动格式化" tabindex="-1"><a class="header-anchor" href="#对用户输入自动格式化" aria-hidden="true">#</a> 对用户输入自动格式化</h2><hr><p>为用户提供输入时的实时格式化特性。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/format-on-type.gif" alt="format-document-type"></p><p>!&gt; <strong>注意</strong>：用户<a href="https://code.visualstudio.com/docs/getstarted/settings" target="_blank" rel="noopener noreferrer">设置<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>中的<code>editor.formatOnType</code>控制着这项功能。</p><h4 id="通过语言服务器实现-14" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-14" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>用户输入格式化</em>特性。当然你的语言服务器还需要响应<code>textDocument/onTypeFormatting</code>请求。你还需要告诉客户端哪些字符可以触发这个特性，<code>moreTriggerCharacters</code>是个可选项。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;documentOnTypeFormattingProvider&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;firstTriggerCharacter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;moreTriggerCharacter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-14" tabindex="-1"><a class="header-anchor" href="#直接实现-14" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoOnTypingFormatter</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>OnTypeFormattingEditProvider<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideOnTypeFormattingEdits</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">,</span> position<span class="token operator">:</span> vscode<span class="token punctuation">.</span>Position<span class="token punctuation">,</span>
        ch<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> options<span class="token operator">:</span> vscode<span class="token punctuation">.</span>FormattingOptions<span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>TextEdit<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerOnTypeFormattingEditProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoOnTypingFormatter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>不提供格式化支持。</p></blockquote><blockquote><p><strong>进阶</strong></p><p>不管多小的文本区域都不要放过，尽可能地对文档进行格式化，这对诊断信息提示至关重要，不然可能导致代码错误位置不正确或者丢失报错标记。</p></blockquote><h2 id="显示取色器" tabindex="-1"><a class="header-anchor" href="#显示取色器" aria-hidden="true">#</a> 显示取色器</h2><hr><p>允许用户预览和修改文档中的颜色。</p><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensionAPI/images/language-support/color-decorators.png" alt="color-decorators"></p><p>!&gt; <strong>注意</strong>：用户<a href="https://code.visualstudio.com/docs/getstarted/settings" target="_blank" rel="noopener noreferrer">设置<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>中的<code>editor.formatOnType</code>控制着这项功能。</p><h4 id="通过语言服务器实现-15" tabindex="-1"><a class="header-anchor" href="#通过语言服务器实现-15" aria-hidden="true">#</a> 通过语言服务器实现</h4><p>除了响应<code>initialize</code>方法外，语言服务器还要声明提供<em>用户输入格式化</em>特性。当然你的语言服务器还需要响应<code>textDocument/documentColor</code>和<code>textDocument/colorPresentation</code>请求。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;capabilities&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;colorProvider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;true&quot;</span>
        ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="直接实现-15" tabindex="-1"><a class="header-anchor" href="#直接实现-15" aria-hidden="true">#</a> 直接实现</h4><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoColorProvider</span> <span class="token keyword">implements</span> <span class="token class-name">vscode</span><span class="token punctuation">.</span>DocumentColorProvider <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">provideDocumentColors</span><span class="token punctuation">(</span>
        document<span class="token operator">:</span> vscode<span class="token punctuation">.</span>TextDocument<span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>ColorInformation<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token function">provideColorPresentations</span><span class="token punctuation">(</span>
        color<span class="token operator">:</span> Color<span class="token punctuation">,</span> context<span class="token operator">:</span> <span class="token punctuation">{</span> document<span class="token operator">:</span> TextDocument<span class="token punctuation">,</span> range<span class="token operator">:</span> Range <span class="token punctuation">}</span><span class="token punctuation">,</span> token<span class="token operator">:</span> vscode<span class="token punctuation">.</span>CancellationToken<span class="token punctuation">)</span><span class="token operator">:</span>
        Thenable<span class="token operator">&lt;</span>vscode<span class="token punctuation">.</span>ColorPresentation<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    ctx<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerColorProvider</span><span class="token punctuation">(</span>
            <span class="token constant">GO_MODE</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GoColorProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>基础</strong></p><p>返回文档中的色彩引用值。提供色彩格式和展示（如：rgb(...)，hsl(...)）</p></blockquote><blockquote><p><strong>进阶</strong></p><p>无</p></blockquote></div><!----><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><a href="/extensibility-reference/extension-manifest.html" class="nav-link prev" aria-label="插件清单文件——pacakge.json"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->插件清单文件——pacakge.json</div></a><a href="/extensibility-reference/overview.html" class="nav-link next" aria-label="扩展性参考"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">扩展性参考<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><a  href='http://beian.miit.gov.cn/' target='_blank'>渝ICP备17004152号-4 | Copyright ©  oorzc</a></div><!----></footer><!--]--></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app.ed9f300c.js" defer></script>
  </body>
</html>
